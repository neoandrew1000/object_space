<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>object space</title>
	<script src="js/three.min.js"></script>
	<script src="js/FirstPersonControls.js"></script>
	<script src="js/markers.js"></script>
<style>
body {
	background: black;
}
</style>
</head>
<body>

<script>
	var scene, camera, render, container, controls;
		
	container  = document.createElement( 'div' );
	document.body.appendChild( container );

	// Extent
	var extent = 0.00001;
	var extentOfTime = 0.1;
    
    // Astronomical unit
    var au = 149598 * extent;

  	// CAMERA -----------------------
	camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.001 * extent, au * 200 );
	camera.position.z = au;
	camera.position.x = 0;
	camera.position.y = au;
	scene  = new THREE.Scene();

	// CONTROLS
	controls = new THREE.FirstPersonControls( camera );

	controls.movementSpeed = 900000 * extent;
	controls.lookSpeed = 0.1;

	// OBJECTS -----------------------
	
	//Font Stars
	var stars, starsGeometry, starsMaterial;

	starsGeometry = new THREE.Geometry();
	starsMaterial = new THREE.ParticleBasicMaterial( { color: 0xe6e6fa, size: 1, sizeAttenuation: false } );

	for( var i = 0; i < 3000; i++ ){
		var vertex = new THREE.Vector3();
		vertex.x = Math.random() * 2 - 1;
		vertex.y = Math.random() * 2 - 1;
		vertex.z = Math.random() * 2 - 1;
		vertex.multiplyScalar( 800000 );
		starsGeometry.vertices.push( vertex );
	}
	stars = new THREE.ParticleSystem( starsGeometry, starsMaterial );
	stars.scale.set( 1000 * extent, 1000 * extent, 1000 * extent );
	scene.add( stars );

	// Ecliptic
	var eclipticLineGeometry = new THREE.CircleGeometry( au * 200, 3 );
	var eclipticLineMaterial = new THREE.MeshBasicMaterial( { color: 0xffaa00, wireframe: true } );
	var eclipticLine         = new THREE.Mesh( eclipticLineGeometry, eclipticLineMaterial );
	scene.add( eclipticLine );
	var eclipticUpPlaneGeometry = new THREE.CircleGeometry( au * 200, 3 );
	var eclipticUpPlaneMaterial = new THREE.MeshBasicMaterial( { color: 0xffaa00, opacity: 0.05, transparent: true } );
	var eclipticUpPlane         = new THREE.Mesh( eclipticUpPlaneGeometry, eclipticUpPlaneMaterial );
	scene.add( eclipticUpPlane );
	var eclipticDownPlaneGeometry = new THREE.CircleGeometry( au * 200, 3);
	var eclipticDownPlaneMaterial = new THREE.MeshBasicMaterial( { color: 0xffaa00, opacity: 0.05, transparent: true } );
	var eclipticDownPlane         = new THREE.Mesh( eclipticDownPlaneGeometry, eclipticDownPlaneMaterial );
	scene.add( eclipticDownPlane );

	// Space Objects
	var SpaceObject = function ( radius, texture, segments, emissive ){
		this.radius   = radius;
		this.segments = segments;
		this.emissive = emissive;
		this.texture  = texture;
		this.init     = function(){
			var spaceObjectGeometry  = new THREE.SphereGeometry( this.radius, this.segments, this.segments );
			var onLoadTexture        = THREE.ImageUtils.loadTexture( this.texture );
			onLoadTexture.anisotropy = 8;
			var spaceObjectMaterial  = new THREE.MeshPhongMaterial({map:onLoadTexture, emissive:this.emissive});
			var spaceObjectMesh      = new THREE.Mesh( spaceObjectGeometry, spaceObjectMaterial ); 

			return spaceObjectMesh;
		};
	};


    // Stars ----
	// Sun
	var sun = new SpaceObject( 696 * extent, "img/sun_texture.jpg", 30, 0xffffff ).init();
	scene.add( sun );

	// Planets ----
	// Mercury
	var mercury = new SpaceObject( 2.4 * extent, "img/mercury_texture.jpg", 18, 0xffffff ).init();
	scene.add( mercury );

	// Venus
	var venus = new SpaceObject( 3.003 * extent, "img/venus_texture.jpg", 18, 0xffffff ).init();
	scene.add( venus );

	// Earth
	var earth = new SpaceObject( 3.135 * extent, "img/earth_texture.jpg", 18, 0xffffff ).init();
	scene.add( earth );
     
    // Mars
	var mars = new SpaceObject( 1.694 * extent, "img/mars_texture.jpg", 18, 0xffffff ).init();
	scene.add( mars );

	// Ceres
	var ceres = new SpaceObject( 0.35 * extent, "img/ceres_texture.jpg", 18, 0xffffff ).init();
	scene.add( ceres );

	// Jupiter
	var jupiter = new SpaceObject( 35 * extent, "img/jupiter_texture.jpg", 18, 0xffffff ).init();
	scene.add( jupiter );

	// Saturn
	var saturn = new SpaceObject( 29 * extent, "img/saturn_texture.jpg", 18, 0xffffff ).init();
	scene.add( saturn );

	// Uranus
	var uranus = new SpaceObject( 12.5 * extent, "img/uranus_texture.jpg", 18, 0xffffff ).init();
	scene.add( uranus );

	// Neptune
	var neptune = new SpaceObject( 12 * extent, "img/neptune_texture.jpg", 18, 0xffffff ).init();
	scene.add( neptune );

	// Pluto
	var pluto = new SpaceObject( 0.55 * extent, "img/pluto_texture.jpg", 18, 0xffffff ).init();
	scene.add( pluto );

	// Haumea
	var haumea = new SpaceObject( 0.35 * extent, "img/aster_texture.jpg", 18, 0xffffff ).init();
	scene.add( haumea );

	// Makemake
	var makemake = new SpaceObject( 0.36 * extent, "img/aster_texture.jpg", 18, 0xffffff ).init();
	scene.add( makemake );

	// Eris
	var eris = new SpaceObject( 1.2 * extent, "img/aster_texture.jpg", 18, 0xffffff ).init();
	scene.add( eris );

	// Markers ----

	// Sun marker
	scene.add( sunMarker );

	// Mercury marker
	scene.add( mercuryMarker );

	// Venus marker
	scene.add( venusMarker );

	// Earth marker
	scene.add( earthMarker );

	// Mars marker
	scene.add( marsMarker );

	// Ceres marker
	scene.add( ceresMarker );

	// Jupiter marker
	scene.add( jupiterMarker );

	// Saturn marker
	scene.add( saturnMarker );

	// Uranus marker
	scene.add( uranusMarker );

	// Neptune marker
	scene.add( neptuneMarker );

	// Pluto marker
	scene.add( plutoMarker );

	// Other planets marker
	scene.add( haumeaMarker );
	scene.add( makemakeMarker );
	scene.add( erisMarker );



	// RENDER -----------------------
	render = new THREE.WebGLRenderer();
	render.setSize( window.innerWidth, window.innerHeight );
	container.appendChild( render.domElement );

	var dt = 0;
	var clock = new THREE.Clock();

	animate();
		
	// ANIMATION -----------------------
	function animate(){		
		requestAnimationFrame( animate );
		
		markersAnimation();
		eclipticPosition();
		objectsPosition();


		// Camera position
		controls.update( clock.getDelta() );

		dt += Math.PI / 180 * 2;
		render.render( scene, camera );
	};

	//Markers animation
	function markersAnimation(){
		markerAnimation( camera, sun, sunMarker );
		markerAnimation( camera, mercury, mercuryMarker );
		markerAnimation( camera, venus, venusMarker );
		markerAnimation( camera, earth, earthMarker );
		markerAnimation( camera, mars, marsMarker );
		markerAnimation( camera, ceres, ceresMarker );
		markerAnimation( camera, jupiter, jupiterMarker );
		markerAnimation( camera, saturn, saturnMarker );
		markerAnimation( camera, uranus, uranusMarker );
		markerAnimation( camera, neptune, neptuneMarker );
		markerAnimation( camera, pluto, plutoMarker );
		markerAnimation( camera, haumea, haumeaMarker );
		markerAnimation( camera, makemake, makemakeMarker );
		markerAnimation( camera, eris, erisMarker );
	};

	function markerAnimation( camera, object, objectMarker ){
		var odject;
		var distanceToObject = Math.sqrt( Math.pow( ( camera.position.x - object.position.x ), 2 ) + Math.pow( ( camera.position.y - object.position.y), 2 ) + Math.pow( ( camera.position.z - object.position.z ), 2 ) );
		objectMarker.scale.set(distanceToObject * markerScale, distanceToObject * markerScale, distanceToObject * markerScale );
		objectMarker.position.x = object.position.x;
       	objectMarker.position.y = object.position.y;
        objectMarker.position.z = object.position.z;
        objectMarker.rotation.z = camera.rotation.z;
       	objectMarker.lookAt(camera.position);

	};
		
    // Planets position
	function planetPosition ( planet, semiMajorAxis, eccentricity, eclipticAngle, positionOnEllipseCos, positionOnEllipseSin, route, velocityOfPlanet, planetAngleOfAxis, planetSpeedRotationOfAxis ){
		var planet, semiMajorAxis, eclipticAngle, route, velocityOfPlanet, planetAngleOfAxis, planetSpeedRotationOfAxis, positionOnEllipseCos, positionOnEllipseSin;
		var semiMinorAxis = ( Math.sqrt( ( 1 - Math.pow( eccentricity, 2 ) ) * Math.pow( semiMajorAxis, 2 ) ) );
		var x = semiMajorAxis * au * Math.sin( ( Math.PI * 2 * ( -route ) ) * dt * extentOfTime * velocityOfPlanet );
		var z = semiMinorAxis * au * Math.cos( ( Math.PI * 2 * ( -route ) ) * dt * extentOfTime * velocityOfPlanet );
		var y = eclipticAngle * extentOfTime * velocityOfPlanet * au * ( Math.cos( ( Math.PI * 2  ) * dt * extentOfTime * velocityOfPlanet ) + Math.sin( ( Math.PI * 2 ) * dt * extentOfTime * velocityOfPlanet ) ) ;
		var as = Math.sin( ( Math.PI * 2 ) * positionOnEllipseSin );
		var ac = Math.cos( ( Math.PI * 2 ) * positionOnEllipseCos );
		planet.position.z = ( x * ac + z * as );
		planet.position.x = ( -x * as + z * ac ) + ( eccentricity * semiMajorAxis );
		planet.position.y += y;
		planet.rotation.z = planetAngleOfAxis;
		planet.rotation.y = planetSpeedRotationOfAxis;

		return planet.position;
	};	

	// Ecliptic position
	function eclipticPosition(){
		eclipticLine.rotation.x      = Math.PI / 2;
		eclipticUpPlane.rotation.x   = Math.PI / 2;
		eclipticDownPlane.rotation.x = -Math.PI / 2;
		
	};
		
	// Objects position
	function objectsPosition(){
		sun.rotation.y += 0.0009;		
		
		planetPosition( mercury, 		 0.3870, 	0.2056, 	0.00400, 	Math.PI * 360, 	Math.PI * 170, 1, 1.000,	 0.003, 0.0009 );
		planetPosition( venus, 			 0.7233, 	0.0068,    -0.00280, 	Math.PI * 60 , 	Math.PI * 90,  1, 0.750,	 0.003, 0.0009 );
		planetPosition( earth, 			 1.0000, 	0.0167, 	0.00000, 	Math.PI * 200, 	Math.PI * 200, 1, 0.610,	 0.003, 0.0009 );
		planetPosition( mars, 			 1.5236, 	0.0934, 	0.00010, 	Math.PI * 10,  	Math.PI * 280, 1, 0.600,	 0.003, 0.0009 );
		planetPosition( ceres, 			 2.7653, 	0.0793,    -0.05000, 	Math.PI * 90,  	Math.PI * 70,  1, 0.380,	 0.003, 0.0009 );
		planetPosition( jupiter, 		 5.4581, 	0.0487, 	0.00009, 	Math.PI * 300, 	Math.PI * 40,  1, 0.270,	 0.003, 0.0009 );
		planetPosition( saturn, 		 9.5820, 	0.0557, 	0.03000, 	Math.PI * 200, 	Math.PI * 20,  1, 0.200,	 0.003, 0.0009 );
		planetPosition( uranus, 		19.2294, 	0.0444, 	0.11000, 	Math.PI * 100, 	Math.PI * 100, 1, 0.150,	 0.003, 0.0009 );
		planetPosition( neptune, 		30.1036, 	0.0112, 	0.20000, 	Math.PI * 300, 	Math.PI * 90,  1, 0.120,	 0.003, 0.0009 );
		planetPosition( pluto, 			39.4816, 	0.2488,    -0.80000, 	Math.PI * 300, 	Math.PI * 24,  1, 0.100,	 0.003, 0.0009 );
		planetPosition( haumea, 		42.9849, 	0.1975,    -1.00000, 	Math.PI * 20,  	Math.PI * 80,  1, 0.095,	 0.003, 0.0009 );
		planetPosition( makemake, 		45.4363, 	0.1625,    -1.20000, 	Math.PI * 100, 	Math.PI * 0,   1, 0.094,	 0.003, 0.0009 );
		planetPosition( eris, 			68.0474, 	0.4347, 	2.00000, 	Math.PI * 300, 	Math.PI * 130, 1, 0.073,	 0.003, 0.0009 );

	};
</script>

</body>
</html>